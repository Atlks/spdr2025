
### 翻页前面页数使用  默认的offset语句即可
### 翻页最后面的若干页数  使用反向排序 毫秒级
 ---特定优化  最后翻页反向翻页。。
select top 10 * from pay_orders_202512 order by id desc

可以通过自定义sql优化器改写sql，业务程序依然使用offset语法


### 中间页数与通用翻页，使用子查询
###  子查询通用，目前每次翻页要俩秒，可以通过参数调优应该可以更加优化
WITH ids AS (
    SELECT id
    FROM pay_orders_202512
    ORDER BY id
    OFFSET (100*10000*10) ROWS FETCH NEXT 10 ROWS ONLY
)
SELECT *
FROM pay_orders_202512
WHERE id IN (SELECT id FROM ids);

###  性能更高版本 最复杂模式，增加额外业务索引行号，任意翻页毫秒级   

  drop table #tmp1
    --建立行号索引，此处初次建立索引较慢可以异步执行
  SELECT 
    ROW_NUMBER() OVER (ORDER BY id) AS rownum,
    id
INTO #tmp1
FROM pay_orders_202512;

select top 3 * from #tmp1 order by id;
CREATE  INDEX CX_tmp1_id ON #tmp1(id);
CREATE CLUSTERED INDEX CX_tmp1_no ON #tmp1(rownum);

select top 5 * from  #tmp1;


  ---翻页截取子查询
    WITH ids AS (
    SELECT top 10 id
    FROM #tmp1 where rownum>100*10000*10
    ORDER BY rownum
     
)
SELECT *
FROM pay_orders_202512
WHERE id IN (SELECT id FROM ids);


####   综合

可以外挂书写增强sql查询优化器，从程序中就使用普通语法offset语法，sql到达查询优化器后，通过解析sql 改写sql语句，根据不同的数据量来使用不同的底层sql ，，来达到更高的性能
也可扩展一些sql性能关键词和函数
使用更加优化的索引策略